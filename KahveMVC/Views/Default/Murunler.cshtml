@using KahveMVC.Models.EntityFramework
@model List<urunler>

@{
    ViewBag.Title = "Menü";
    Layout = "~/Views/Shared/_Layout.cshtml";
}

<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/swiper@11/swiper-bundle.min.css" />

<style>
    .slider-container {
        position: relative;
        width: 100%;
        padding-top: 30px;
        padding-bottom: 50px;
        overflow: hidden;
    }

    .swiper {
        width: 100%;
        padding-bottom: 50px;
    }

    .swiper-slide {
        width: 400px; /* Genişliği mobilyaya uygun yaptım */
        display: flex;
        flex-direction: column;
        align-items: center;
        opacity: 0.5;
        transform: scale(0.9);
        transition: all 0.3s ease;
    }

        .swiper-slide img {
            width: 100%;
            height: 300px;
            object-fit: cover;
            border-radius: 10px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.3);
        }

    .swiper-slide-active {
        opacity: 1 !important;
        transform: scale(1.05) !important;
        z-index: 10;
    }

    /* --- OKUNABİLİRLİK VE STOK GÖSTERİMİ --- */
    .urun-bilgi {
        text-align: center;
        margin-top: -20px; /* Resmin biraz üstüne binsin */
        padding: 20px;
        background-color: rgba(255, 255, 255, 0.95); /* Opak Beyaz Arka Plan */
        border-radius: 10px;
        width: 90%;
        box-shadow: 0 10px 20px rgba(0,0,0,0.2); /* Gölge */
        opacity: 0;
        transition: opacity 0.3s ease;
        position: relative;
        z-index: 20;
    }

    .swiper-slide-active .urun-bilgi {
        opacity: 1;
    }

    .badge-stok {
        font-size: 0.8rem;
        padding: 5px 10px;
        border-radius: 20px;
        position: absolute;
        top: -15px;
        right: 10px;
        box-shadow: 0 2px 5px rgba(0,0,0,0.2);
    }

    .swiper-button-next, .swiper-button-prev {
        color: #2c3e50; /* Koyu Lacivert */
        background: rgba(255, 255, 255, 0.9);
        width: 50px;
        height: 50px;
        border-radius: 50%;
        font-weight: bold;
    }
</style>

<div class="container-fluid py-4">

    @if (TempData["StokHata"] != null)
    {
        <div class="alert alert-danger text-center mx-auto w-50">
            @TempData["StokHata"]
        </div>
    }

    <div class="text-center mb-4">
        <h2 class="site-heading-upper" style="color: #e67e22; font-weight: bold;">KOLEKSİYONUMUZ</h2>
        <p class="text-white">Detaylı incelemek için kartları kaydırın.</p>
    </div>

    <div class="slider-container">
        <div class="swiper mySwiper">
            <div class="swiper-wrapper">

                @foreach (var urun in Model)
                {
                    <div class="swiper-slide">
                        <img src="~/Content/img/@urun.foto" alt="@urun.baslik">

                        <div class="urun-bilgi">

                            @if (urun.stok == 0)
                            {
                                <span class="badge badge-danger badge-stok">TÜKENDİ</span>
                            }
                            else if (urun.stok < 5)
                            {
                                <span class="badge badge-warning badge-stok text-white">Son @urun.stok Ürün!</span>
                            }
                            else
                            {
                                <span class="badge badge-success badge-stok">Stokta Var</span>
                            }

                            <h4 style="color:#2c3e50; font-weight:800; margin-bottom:5px;">@urun.baslik</h4>
                            <h3 class="text-primary font-weight-bold">@urun.Fiyat ₺</h3>

                            <div class="mt-3">
                                @if (urun.stok > 0)
                                {
                                    <a href="/Sepet/SepeteEkle/@urun.id" class="btn btn-primary font-weight-bold">
                                        Sepete Ekle
                                    </a>
                                }
                                else
                                {
                                    <button class="btn btn-secondary" disabled>Stok Yok</button>
                                }

                                <a href="@Url.Action("UrunDetay", "Default", new { id = urun.id, baslik = Turkce.AdresDuzenle(urun.baslik) })"
                                   class="btn btn-outline-dark btn-sm ml-2">
                                    İncele
                                </a>
                            </div>
                        </div>
                    </div>
                }

            </div>
        </div>
        <div class="swiper-button-next"></div>
        <div class="swiper-button-prev"></div>
    </div>
</div>

<script src="https://cdn.jsdelivr.net/npm/swiper@11/swiper-bundle.min.js"></script>
<script>
    var swiper = new Swiper(".mySwiper", {
        effect: "coverflow",
        grabCursor: true,
        centeredSlides: true,
        slidesPerView: "auto",
        coverflowEffect: {
            rotate: 0,
            stretch: 0,
            depth: 150,
            modifier: 1.5,
            slideShadows: false,
        },
        navigation: {
            nextEl: ".swiper-button-next",
            prevEl: ".swiper-button-prev",
        },
    });
</script>